---
import { getRelativeLocaleUrl } from 'astro:i18n';
import Dot from './Dot.astro';
import HeaderLink from './HeaderLink.astro';

import { SITE_TITLE } from '../consts';

interface	Props {
	active: 'index' | 'blog' | 'projects' | 'about';
	navLinks: {
		articles: string;
		projects: string;
		about: string;
	};
}

const { active, navLinks } = Astro.props;
const currentLocale = Astro.currentLocale || 'en';

const links = [
	{ link: 'blog', name: navLinks.articles },
	{ link: 'projects', name: navLinks.projects },
	{ link: 'about', name: navLinks.about },
];

// Generate locale-aware URLs for language switcher
const switcherPath = active === 'index' ? '/' : `/${active}`;
const enUrl = getRelativeLocaleUrl('en', switcherPath);
const plUrl = getRelativeLocaleUrl('pl', switcherPath);
const homeUrl = getRelativeLocaleUrl(currentLocale, '/');
---

<header>
	<nav class="top">
		<h4>
			<a href={homeUrl}>
				{SITE_TITLE}
				{active === 'index' && (<Dot />)}
			</a>
		</h4>
		<div class="languages">
			<a href={enUrl}>en</a>
			/
			<a href={plUrl}>pl</a>
		</div>
	</nav>

	<nav class="bottom">
		{links.map(({link, name}) => (
		<HeaderLink locale={currentLocale} active={active} link={link} name={name} />
		))}
	</nav>
</header>

<style>
header {
	margin: 0;
	padding: 2rem;
	background: var(--background);
	box-shadow: 0 2px 8px rgba(var(--black), 5%);
	border-bottom: 1px solid var(--background-surface);
}

nav {
	display: flex;
	align-items: center;
	justify-content: space-between;
	max-width: 720px;
	margin: auto;
	gap: 0.5rem;

	@media screen and (max-width: 550px) {
		flex-direction: column;
	}
}

a {
	text-decoration: none;
	color: var(--brand-7);
	font-family: var(--body-font);
	letter-spacing: 0;
}

.languages {
	font-variant: small-caps;

	color: var(--background-surface);

	a {
		text-decoration: none;
		color: var(--foreground);
		transition: color 100ms;
	}

	a:hover {
		color: var(--brand-7);
	}
}
</style>
